---
title: Leetcode 304
date: 2021-04-07 00:26:20
tags:
cover_img:
feature_img:
description: Range Sum Query 2D - Immutable
keywords:
---
[Original Link](https://leetcode.com/problems/range-sum-query-2d-immutable/)

Given a 2D matrix `matrix`, find the sum of the elements inside the rectangle defined by its upper left corner `(row1, col1)` and lower right corner `(row2, col2)`.

Implement the NumMatrix class:
- `NumMatrix(int[][] matrix)` initializes the object with the integer matrix `matrix`.
- int `sumRegion(int row1, int col1, int row2, int col2)` returns the sum of the elements of the `matrix` array inside the rectangle defined by its upper left corner `(row1, col1)` and lower right corner `(row2, col2)`.

**Example:**
![example](/images/lc_304_1.jpeg)

与通过`O(n)`的辅助数组`O(1)`算出`A[i, j]`之和一样，可以通过`O(n^2)`的辅助数组`O(1)`算出`A[ij]`与`A[kl]`选定的矩形框之和。
![answer](/images/lc_304.jpeg)
用`F[i, j]`表示从`(0, 0)`到`(i, j)`的元素之和，则
```
sumRegion(int row1, int col1, int row2, int col2) = F[row2, col2] - F[row2, col1-1] - F[row1-1, col2] + F[row1-1, col1-1]
```

```
class NumMatrix {
public:
    NumMatrix(vector<vector<int>>& matrix) {
        int n = matrix.size(), m = matrix[0].size();
        for (int i = 0; i < n; i++){
            f.emplace_back(vector<int>(m, 0));
        }
        for (int i = 0; i< matrix.size(); i++) {
       f[i][0] = matrix[i][0];
        }
       for (int i = 0; i < matrix.size(); i++) {
           for (int j = 1; j < matrix[0].size(); j++) {
               f[i][j] = f[i][j-1] + matrix[i][j]; 
            }
           if (i !=0) {
               for (int j = 0; j < matrix[0].size(); j++) {
                   f[i][j] += f[i-1][j];
               }
           }
       }
    }
    
    int sumRegion(int row1, int col1, int row2, int col2) {
       int a =0, b = 0, c = 0, d = f[row2][col2];
       if (row1 > 0) {
           b = f[row1-1][col2];
       }
       if (col1 > 0) {
           c = f[row2][col1-1];
       } 
       if (row1 > 0 && col1>0) {
           a = f[row1-1][col1-1];
       }
        return d+a-b-c;
    }
    vector<vector<int> > f;
};
```
